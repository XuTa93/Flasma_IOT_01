<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:Flasma_IOT_01.ViewModels" 
        xmlns:lvc="using:LiveChartsCore.SkiaSharpView.Avalonia"
        xmlns:dataGrid="clr-namespace:Avalonia.Controls;assembly=Avalonia.Controls.DataGrid"
        mc:Ignorable="d"
        Width="1100"
        Height="700"
        x:Class="Flasma_IOT_01.Views.MainWindow"
        Title="Flasma IOT"
        x:DataType="vm:MainWindowViewModel">

    <Grid RowDefinitions="*,Auto">

        <!-- ================= TAB AREA ================= -->
        <TabControl Grid.Row="0"
            HorizontalContentAlignment="Stretch"
            VerticalContentAlignment="Stretch">


            <!-- ================= HISTORY TAB ================= -->
          <TabItem Header="History">
    <Grid RowDefinitions="*">

        <dataGrid:DataGrid
            x:CompileBindings="False"
            ItemsSource="{Binding HistoryRecords}"
            AutoGenerateColumns="False"
            HeadersVisibility="Column"
            GridLinesVisibility="All"
            Background="White"
            BorderBrush="Black"
            BorderThickness="1">

            <dataGrid:DataGrid.Columns>
                <dataGrid:DataGridTextColumn Header="ID" Binding="{Binding Id}" />
                <dataGrid:DataGridTextColumn Header="Start Time" Binding="{Binding StartTime}" />
                <dataGrid:DataGridTextColumn Header="End Time" Binding="{Binding EndTime}" />
                <dataGrid:DataGridTextColumn Header="Duration" Binding="{Binding Duration}" />
                <dataGrid:DataGridTextColumn Header="Barcode" Binding="{Binding Barcode}" />
                <dataGrid:DataGridTextColumn Header="Result" Binding="{Binding Result}" />
                <dataGrid:DataGridTextColumn Header="Avg Voltage" Binding="{Binding AvgVoltage}" />
                <dataGrid:DataGridTextColumn Header="Avg Current" Binding="{Binding AvgCurrent}" />
                <dataGrid:DataGridTextColumn Header="File Path" Binding="{Binding FilePath}" />
            </dataGrid:DataGrid.Columns>

        </dataGrid:DataGrid>

    </Grid>
</TabItem>


            <!-- ================= CHART TAB ================= -->
            <TabItem Header="Chart">
                <!-- Gi? nguyên ph?n Chart -->
                <Border Background="#1A1A1A"
                        Padding="20">
                    <Grid RowDefinitions="*,*"
                          RowSpacing="10">
            
                        <!-- VOLTAGE CHART -->
                        <Border Grid.Row="0"
                                Background="#1A1A1A"
                                BorderBrush="#444"
                                BorderThickness="1"
                                Padding="5,10,5,5">
                            <Grid RowDefinitions="Auto,*">
                                <TextBlock Grid.Row="0"
                                           Text="Voltage (V)"
                                           Foreground="White"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,5"/>
                                <!-- VOLTAGE CHART -->
                                <lvc:CartesianChart Grid.Row="1"
                                                    Series="{Binding VoltageSeries}"
                                                    XAxes="{Binding VoltageXAxes}"
                                                    YAxes="{Binding VoltageYAxes}"
                                                    LegendPosition="Hidden"
                                                    Background="#1A1A1A">
                                    <lvc:CartesianChart.Styles>
                                        <Style Selector="TextBlock">
                                            <Setter Property="FontSize" Value="12"/>
                                        </Style>
                                    </lvc:CartesianChart.Styles>
                                </lvc:CartesianChart>
                            </Grid>
                        </Border>

                        <!-- CURRENT CHART -->
                        <Border Grid.Row="1"
                                Background="#1A1A1A"
                                BorderBrush="#444"
                                BorderThickness="1"
                                Padding="5,10,5,5">
                            <Grid RowDefinitions="Auto,*">
                                <TextBlock Grid.Row="0"
                                           Text="Current (A)"
                                           Foreground="White"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,5"/>
                                <!-- CURRENT CHART -->
                                <lvc:CartesianChart Grid.Row="1"
                                                    Series="{Binding CurrentSeries}"
                                                    XAxes="{Binding CurrentXAxes}"
                                                    YAxes="{Binding CurrentYAxes}"
                                                    LegendPosition="Hidden"
                                                    Background="#1A1A1A">
                                    <lvc:CartesianChart.Styles>
                                        <Style Selector="TextBlock">
                                            <Setter Property="FontSize" Value="12"/>
                                        </Style>
                                    </lvc:CartesianChart.Styles>
                                </lvc:CartesianChart>
                            </Grid>
                        </Border>

                    </Grid>
                </Border>
            </TabItem>

        </TabControl>

        <!-- ================= CONTROL PANEL ================= -->
        <Grid Grid.Row="1"
              Margin="10"
              ColumnDefinitions="*,Auto"
              RowDefinitions="Auto,Auto"
              ColumnSpacing="20">

            <!-- STATUS - BINDING V?I VIEWMODEL -->
            <StackPanel Orientation="Horizontal" Spacing="30">
                <TextBlock Text="{Binding Voltage, StringFormat='Voltage: {0:F2}V'}"/>
                <TextBlock Text="{Binding Current, StringFormat='Current: {0:F2}A'}"/>
            </StackPanel>

            <!-- RIGHT STATUS -->
            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        Spacing="10">
                <TextBlock Text="{Binding Power, StringFormat='Power: {0:F2}W'}"/>
                <CheckBox Content="Dummy Mode (Test)"/>
            </StackPanel>

            <!-- BUTTONS -->
            <StackPanel Grid.Row="1"
                        Orientation="Horizontal"
                        Spacing="10">

                <Button Content="Connect"/>
                <Button Content="DisConnect"/>
                <Button Content="Start" Command="{Binding ButtonStartPressedCommand}" FontSize="15"/>
                <Button Content="Stop"/>
                <Button Content="Get Data"/>

                <TextBlock Text="Barcode"
                           VerticalAlignment="Center"
                           Margin="20,0,0,0"/>

                <TextBox Width="150"
                         Watermark="Code text"/>
            </StackPanel>

        </Grid>

    </Grid>
</Window>